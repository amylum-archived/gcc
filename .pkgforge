name 'gcc'
org 'amylum'

licenses 'COPYING'

deps(
  mpfr: {
    version: '4.0.1-2',
    checksum: '629ce14a414965b5967ee3ff95f40edbc1e62cd97e4a487ed302fae3de1da486'
  },
  gmp: {
    version: '6.1.2-1',
    checksum: '12515de758fa11b2b3d87b347d0593fc8bde37b32a6c609cbddd09473e180b08'
  },
  mpc: {
    version: '1.1.0-1',
    checksum: '8fabbb62363cb193e668f38a13cd1f18491e915c44195aca7ba14acbfec28cc3'
  }
)

source(
  type: 'tar',
  url: 'https://mirrors.kernel.org/gnu/gcc/gcc-8.2.0/gcc-8.2.0.tar.gz',
  checksum: '1b0f36be1045ff58cbb9c83743835367b860810f17f0195a4e093458b372020f'
)

configure_flags(
  prefix: '/usr',
  'disable-multilib': nil
)

harden
cflags
cflags([
  '-Wno-error=format-security',
])

build do
  env = { 'CXX' => 'musl-gcc' }
  configure env
  make env
  install env
end

test do
  # TODO: add tests
end
